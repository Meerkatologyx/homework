<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Homework Tracker</title>
  <!-- FullCalendar CSS -->
  <link href="https://cdn.jsdelivr.net/npm/fullcalendar@5.11.3/main.min.css" rel="stylesheet" />
  <style>
    /* Hide both views by default */
    #dashboardView, #calendarView {
      display: none;
    }
    /* When active, show with appropriate layout */
    #dashboardView.active {
      display: grid;
      gap: 24px;
      margin-top: 20px;
    }
    #calendarView.active {
      display: block;
    }

    /* Global Styles */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell;
    }
    :root {
      --primary: #0a84ff;
      --background: #000;
      --surface: #1c1c1e;
      --secondary-surface: #2c2c2e;
      --text: #fff;
      --secondary-text: #86868b;
    }
    body {
      background: var(--background);
      color: var(--text);
      min-height: 100vh;
    }
    .container {
      max-width: 768px;
      margin: 0 auto;
      padding: 20px;
      padding-bottom: 80px;
    }
    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 24px;
      padding: 0 10px;
    }
    .header h1 {
      font-size: 32px;
      font-weight: 800;
      letter-spacing: -0.5px;
    }
    #addClassButton {
      background: var(--primary);
      border: none;
      color: white;
      padding: 8px 16px;
      border-radius: 10px;
      font-size: 14px;
      cursor: pointer;
      font-weight: 600;
    }
    /* Dashboard Layout */
    .due-section {
      background: var(--surface);
      border-radius: 16px;
      padding: 16px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
    }
    .due-section h3 {
      font-size: 18px;
      margin-bottom: 16px;
      color: var(--primary);
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .due-section h3::before {
      content: 'üìÖ';
      font-size: 16px;
    }
    .all-homework-section {
      margin-top: 12px;
    }
    .all-homework-section h3 {
      font-size: 18px;
      margin-bottom: 16px;
      color: var(--text);
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .all-homework-section h3::before {
      content: 'üìö';
      font-size: 16px;
    }
    .homework-grid {
      display: grid;
      gap: 12px;
    }
    .homework-card {
      background: var(--secondary-surface);
      padding: 18px;
      border-radius: 12px;
      border-left: 4px solid var(--primary);
      transition: transform 0.2s, box-shadow 0.2s;
    }
    .homework-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(10, 132, 255, 0.1);
    }
    .homework-card h3 {
      font-size: 16px;
      margin-bottom: 4px;
    }
    .due-date {
      font-size: 13px;
      color: var(--secondary-text);
      display: flex;
      align-items: center;
      gap: 6px;
    }
    .due-date::before {
      content: '‚è∞';
      font-size: 12px;
    }
    .empty-state {
      text-align: center;
      padding: 32px 0;
      color: var(--secondary-text);
    }
    /* Class List Styling */
    #classList {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
      margin-bottom: 24px;
    }
    .class-chip {
      background: var(--secondary-surface);
      padding: 6px 12px;
      border-radius: 20px;
      font-size: 12px;
      display: flex;
      align-items: center;
      gap: 6px;
    }
    .class-chip button {
      background: rgba(255, 255, 255, 0.1);
      padding: 2px;
      border-radius: 50%;
      width: 18px;
      height: 18px;
      display: grid;
      place-items: center;
      border: none;
      color: var(--text);
      cursor: pointer;
    }
    /* Calendar Styles */
    #calendar {
      background: var(--surface);
      border-radius: 14px;
      padding: 10px;
      margin-top: 20px;
    }
    .fc {
      font-size: 12px;
      background: var(--surface);
      border: none;
      color: var(--text);
    }
    .fc-header-toolbar {
      background: var(--secondary-surface);
      border: none;
      border-radius: 10px;
      padding: 4px;
      margin-bottom: 12px;
    }
    /* Override FullCalendar Button Styles to Match Theme */
    .fc-button {
      background-color: var(--primary) !important;
      border: none !important;
      border-radius: 10px !important;
      color: var(--text) !important;
      font-size: 14px;
      padding: 6px 10px;
      cursor: pointer;
    }
    .fc-button:hover {
      background-color: var(--primary) !important;
      filter: brightness(110%);
    }
    .fc-button:focus {
      outline: none;
    }
    .fc-button-active {
      background-color: var(--primary) !important;
      color: var(--text) !important;
    }
    /* Override today's cell styling */
    .fc-day-today {
      background-color: #3a3a3a !important;
    }
    /* Custom Homework Bubble for Calendar Cells */
    .homework-bubble {
      position: absolute;
      top: 4px;
      left: 4px;
      background: var(--primary);
      color: var(--text);
      /* Slightly shrink the bubble container */
      width: 18px;
      height: 18px;
      border-radius: 50%;
      /* Keep the number's font size unchanged */
      font-size: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    /* Modal Styles */
    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      backdrop-filter: blur(8px);
      z-index: 10;
    }
    .modal-content {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      background: var(--surface);
      border-radius: 24px 24px 0 0;
      padding: 24px;
      transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }
    .modal-header h2 {
      font-size: 24px;
      margin-bottom: 24px;
    }
    .input-group {
      margin-bottom: 20px;
    }
    .input-field {
      width: 100%;
      padding: 8px;
      background: var(--secondary-surface);
      border: none;
      border-radius: 10px;
      color: var(--text);
      font-size: 14px;
    }
    /* Style buttons inside modals to match the theme */
    .modal .modal-content button {
      background: var(--primary);
      color: var(--text);
      border: none;
      padding: 8px 16px;
      border-radius: 10px;
      font-size: 14px;
      cursor: pointer;
      font-weight: 600;
    }
    .modal .modal-content button:hover {
      filter: brightness(110%);
    }
    /* Style the Mark Complete button like the theme */
    .complete-btn {
      background: var(--primary);
      border: none;
      color: var(--text);
      padding: 6px 12px;
      border-radius: 10px;
      font-size: 14px;
      cursor: pointer;
      margin-top: 8px;
    }
    .complete-btn:hover {
      filter: brightness(110%);
    }
    /* Navigation Bar */
    .nav-bar {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      background: var(--surface);
      padding: 12px 20px;
      display: flex;
      justify-content: space-between;
      border-top: 0.5px solid #38383a;
      backdrop-filter: blur(20px);
    }
    .nav-item {
      padding: 6px;
      border-radius: 8px;
      transition: background 0.2s;
      color: var(--secondary-text);
      cursor: pointer;
      font-size: 12px;
    }
    .nav-item.active {
      color: var(--primary);
      background: rgba(10, 132, 255, 0.1);
    }
    .add-btn {
      position: fixed;
      bottom: 70px;
      right: 20px;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background: var(--primary);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      box-shadow: 0 4px 8px rgba(10, 132, 255, 0.3);
      border: none;
      color: white;
      font-size: 24px;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>Homework</h1>
      <button id="addClassButton">Add Class</button>
    </div>
    
    <div id="classList"></div>

    <!-- Dashboard View (active by default) -->
    <div id="dashboardView" class="active">
      <div class="due-section">
        <h3>Due Today</h3>
        <div class="homework-grid" id="dueToday"></div>
        <div class="empty-state" id="dueTodayEmpty" style="display: none;">Nothing due today! üéâ</div>
      </div>

      <div class="all-homework-section">
        <h3>All Homework</h3>
        <div class="homework-list" id="homeworkList"></div>
        <div class="empty-state" id="homeworkEmpty" style="display: none;">No homework yet! Click + to add üìù</div>
      </div>
    </div>

    <!-- Calendar View -->
    <div id="calendarView">
      <div id="calendar"></div>
    </div>

    <button class="add-btn" onclick="showModal()">+</button>
    
    <div class="nav-bar">
      <div class="nav-item active" onclick="switchView('dashboard')">üìö Dashboard</div>
      <div class="nav-item" onclick="switchView('calendar')">üìÖ Calendar</div>
    </div>

    <!-- Homework Modal -->
    <div class="modal" id="modal">
      <div class="modal-content">
        <div class="modal-handle"></div>
        <div class="modal-header">
          <h2>New Homework</h2>
        </div>
        <div class="input-group">
          <label>Class</label>
          <select class="input-field ios-select" id="homeworkClass">
            <option value="">Select Class</option>
          </select>
        </div>
        <div class="input-group">
          <label>Assignment</label>
          <input type="text" class="input-field" id="homeworkName" placeholder="Enter homework name">
        </div>
        <div class="input-group">
          <label>Due Date</label>
          <input type="datetime-local" class="input-field" id="homeworkDue">
        </div>
        <button onclick="addHomework()">Add Homework</button>
      </div>
    </div>

    <!-- Class Modal -->
    <div class="modal" id="classModal">
      <div class="modal-content">
        <div class="modal-handle"></div>
        <div class="modal-header">
          <h2>New Class</h2>
        </div>
        <div class="input-group">
          <label>Class Name</label>
          <input type="text" class="input-field" id="className" placeholder="Enter class name">
        </div>
        <button onclick="createClass()">Add Class</button>
      </div>
    </div>
  </div>

  <!-- FullCalendar JS -->
  <script src="https://cdn.jsdelivr.net/npm/fullcalendar@5.11.3/main.min.js"></script>
  <script>
    let classes = JSON.parse(localStorage.getItem('classes')) || [];
    let homework = JSON.parse(localStorage.getItem('homework')) || [];
    let calendar;

    function initializeCalendar() {
      const calendarEl = document.getElementById('calendar');
      calendar = new FullCalendar.Calendar(calendarEl, {
        initialView: 'dayGridMonth',
        eventDisplay: 'none', // Hide default event text
        headerToolbar: {
          left: 'prev,title,next',
          right: 'today,dayGridMonth,timeGridWeek,timeGridDay'
        },
        events: homework.map(hw => ({
          title: hw.name,
          start: hw.due,
          color: classes.find(c => c.name === hw.class)?.color || '#0a84ff',
          textColor: '#ffffff'
        })),
        fixedWeekCount: false,
        dayMaxEvents: 2,
        eventBorderColor: 'transparent',
        // Add a custom bubble to each day cell if homework exists that day
        dayCellDidMount: function(arg) {
          let dateStr = arg.date.toISOString().split('T')[0];
          let count = homework.filter(hw => hw.due.split('T')[0] === dateStr).length;
          if(count > 0) {
            let bubble = document.createElement('div');
            bubble.className = 'homework-bubble';
            bubble.innerText = count;
            // Ensure the cell is positioned relatively so the bubble is placed correctly
            arg.el.style.position = 'relative';
            arg.el.appendChild(bubble);
          }
        }
      });
      calendar.render();
    }

    function switchView(view) {
      // Remove active class from both views
      document.getElementById('dashboardView').classList.remove('active');
      document.getElementById('calendarView').classList.remove('active');
      // Remove active class from nav items
      document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));

      if (view === 'dashboard') {
        document.getElementById('dashboardView').classList.add('active');
        document.querySelector('.nav-item[onclick="switchView(\'dashboard\')"]').classList.add('active');
      } else {
        document.getElementById('calendarView').classList.add('active');
        document.querySelector('.nav-item[onclick="switchView(\'calendar\')"]').classList.add('active');
        if (!calendar) initializeCalendar();
      }
    }

    // Modal Handling
    document.getElementById('modal').addEventListener('click', function(e) {
      if (e.target === this) hideModal();
    });
    document.getElementById('classModal').addEventListener('click', function(e) {
      if (e.target === this) hideClassModal();
    });

    function showModal() {
      document.getElementById('modal').style.display = 'block';
      setTimeout(() => document.getElementById('modal').classList.add('active'), 10);
    }
    function hideModal() {
      document.getElementById('modal').classList.remove('active');
      setTimeout(() => document.getElementById('modal').style.display = 'none', 300);
    }

    function showClassModal() {
      document.getElementById('classModal').style.display = 'block';
      setTimeout(() => document.getElementById('classModal').classList.add('active'), 10);
    }
    function hideClassModal() {
      document.getElementById('classModal').classList.remove('active');
      setTimeout(() => document.getElementById('classModal').style.display = 'none', 300);
    }

    document.getElementById('addClassButton').addEventListener('click', showClassModal);

    // Class Management
    function addClass(name) {
      classes.push({ name, color: `hsl(${Math.random() * 360}, 70%, 60%)` });
      localStorage.setItem('classes', JSON.stringify(classes));
      updateClassList();
      renderClassList();
    }

    function createClass() {
      const name = document.getElementById('className').value.trim();
      if (name) addClass(name);
      hideClassModal();
    }

    function updateClassList() {
      const classSelect = document.getElementById('homeworkClass');
      classSelect.innerHTML = '<option value="">Select Class</option>' + 
        classes.map(c => `<option value="${c.name}">${c.name}</option>`).join('');
    }

    function renderClassList() {
      const classListEl = document.getElementById('classList');
      classListEl.innerHTML = classes.map(c => `
        <div class="class-chip">
          <span>${c.name}</span>
          <button onclick="deleteClass('${c.name}')">√ó</button>
        </div>
      `).join('');
    }

    function deleteClass(className) {
      classes = classes.filter(c => c.name !== className);
      localStorage.setItem('classes', JSON.stringify(classes));
      updateClassList();
      renderClassList();
    }

    // Homework Management
    function addHomework() {
      const homeworkItem = {
        class: document.getElementById('homeworkClass').value,
        name: document.getElementById('homeworkName').value,
        due: document.getElementById('homeworkDue').value,
        completed: false
      };
      homework.push(homeworkItem);
      localStorage.setItem('homework', JSON.stringify(homework));
      updateHomeworkDisplay();
      if (calendar) calendar.refetchEvents();
      hideModal();
    }

    function completeHomework(index) {
      homework.splice(index, 1);
      localStorage.setItem('homework', JSON.stringify(homework));
      updateHomeworkDisplay();
      if (calendar) calendar.refetchEvents();
    }

    function updateHomeworkDisplay() {
      const homeworkListEl = document.getElementById('homeworkList');
      const dueTodayEl = document.getElementById('dueToday');
      const dueTodayEmpty = document.getElementById('dueTodayEmpty');
      const homeworkEmpty = document.getElementById('homeworkEmpty');
      
      let homeworkCards = "";
      let dueTodayCards = "";
      const today = new Date().toISOString().split('T')[0];
      let dueTodayCount = 0;

      homework.forEach((hw, index) => {
        const card = `
          <div class="homework-card">
            <h3>${hw.name}</h3>
            <div class="due-date">
              ${hw.class} ‚Ä¢ ${new Date(hw.due).toLocaleDateString('en-US', {
                month: 'short',
                day: 'numeric',
                hour: 'numeric',
                minute: '2-digit'
              })}
            </div>
            <button class="complete-btn" onclick="completeHomework(${index})">Mark Complete</button>
          </div>
        `;
        homeworkCards += card;
        let dueDate = new Date(hw.due).toISOString().split('T')[0];
        if (dueDate === today) {
          dueTodayCards += card;
          dueTodayCount++;
        }
      });

      homeworkListEl.innerHTML = homeworkCards;
      dueTodayEl.innerHTML = dueTodayCards;
      dueTodayEmpty.style.display = dueTodayCount > 0 ? 'none' : 'block';
      homeworkEmpty.style.display = homework.length > 0 ? 'none' : 'block';
    }

    // Initialize
    updateClassList();
    renderClassList();
    updateHomeworkDisplay();
    switchView('dashboard');
  </script>
</body>
</html>